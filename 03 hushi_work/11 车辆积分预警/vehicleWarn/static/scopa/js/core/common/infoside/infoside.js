define("scopa/core/common/infoside/infoside",["./group","./details","core/common/customelement","./hartsdetails","./timereel","jqueryui"],function(a,b,c){var d={graph:null,eventModule:null,container:null,group:!0,details:!0,timereel:!0,selectec:!0,scale:"full"},e={templete:staticUrl+"/scopa/template/core/infoside.html"};window.scopa_infosideaction=!1,c.exports=function(){var b=new(a("./group")),c=new(a("./details")),f=new(a("./timereel")),g=null,h=null,i=null,j=null,k=null,l=null,m=function(a){g=$.extend({},d,a),h=g.graph,i=g.eventModule,l=g.container="string"==typeof g.container?$(g.container):g.container},n=function(a){m(a),mining.utils.isEmpty(h)||l.size()<1||(l.hasClass("infoside")||l.addClass("infoside"),l.data("config",g),o(function(){g.group&&b.init(g),r(g),l.off("click","[tab]").on("click","[tab]",function(){var a=$(this).attr("tab");l=$(this).parents(".infoside:first"),g=l.data("config"),p(a);var b=49,c="";"info-group"==a?c="统计":"info-details"==a?c="详情":"info-timereel"==a&&(c="时间卷轴"),$(".page-map .breadnav-map").hasClass("active")&&(b=69),mining.utils.serverLog(b,c)}),$(".scalebtn,.scaleimg",l).off("click").on("click",function(){$(".scalebtn-full",l).is(":visible")?u($.extend(g,{scale:"small"})):u($.extend(g,{scale:"full"}))})}))},o=function(a){return $(".info-group",l).size()>0?(a.call(),void 0):($ajax.ajax({url:e.templete,success:function(b){l.html(b),a.call()},error:function(a){seajs.log(a)}}),void 0)},p=function(a){if(window.scopa_infosideaction_timereel&&!window.scopa_infosideaction_timereel_click)return window.scopa_infosideaction_timereel=!1,void 0;window.scopa_infosideaction_timereel_click=!1;var b=$("[tab="+a+"]",l),c=30,d=32;b.size()<1||g[a.replace("info-","")]&&(b.addClass("active").siblings(".active").removeClass("active"),"info-timereel"==a&&(c=15,d=64),$(".nav-active",l).animate({left:350-mining.browser.w+b.offset().left+c,width:d},{duration:300,easing:"easeOutQuart"}),$("."+a,l).show().siblings().not(".nav,.scalebox").hide(),q(a))},q=function(a){var d=$("."+a,l);if("true"!=d.attr("init")){switch(k=[],i&&(k=i.getdata(":selected")),$.extend(g,{container:l,selection:j,eventarr:k,details:c}),a){case"info-group":b.init(g);break;case"info-details":c.init(g);break;case"info-timereel":f.init(g)}d.attr("init","true")}},r=function(a){m(a);var b=h.$(":selected").length>0&&g.selectec?h.$(":selected"):h.elements();j=b,k=[],i&&(k=i.getdata(":selected")),scopa_infosideaction=!1,$(".info-group,.info-details,.info-timereel",l).attr("init","false"),p("info-group")},s=function(a){m(a);var b=h.$(":selected").length>0&&g.selectec?h.$(":selected"):h.elements();j=b,k=[],i&&(k=i.getdata(":selected")),scopa_infosideaction=!1,$(".info-group,.info-details,.info-timereel",l).attr("init","false");var c="";$(".info-group,.info-details,.info-timereel",l).attr("init","false"),c=!g.details||1!=k.length&&1!=h.nodes(":selected").length&&1!=h.nodes(".entity:selected").length&&1!=h.edges(".relation:selected").length?"info-group":"info-details",window.scopa_infosideaction_timereel_click&&(c="info-details"),p(c)},t=!1,u=function(a){if(!t){t=!0,m(a);var b=l.siblings(".grahpside"),c=parseInt($(".graphnavigator",b).css("left"));"small"==a.scale&&$(".scalebox .scalebtn-small",l).is(":hidden")?(l.data("scale",{width:l.width(),height:l.height()}),l.animate({width:78,height:129},300),b.animate({"padding-right":0},300),$(".ui-cytoscape-panzoom",b).animate({top:60},300),$(".graphnavigator",b).animate({left:c+350},300),$(".scalebox",l).width(78).height(129),$(".scalebox .scalebtn-small",l).show(),$(".scalebox .scalebtn-full",l).hide(),setTimeout(function(){$(".scalebox .scaleimg",l).fadeIn(300)},200)):"full"==a.scale&&$(".scalebox .scalebtn-full",l).is(":hidden")&&(l.animate(l.data("scale"),300),b.animate({"padding-right":350},300),$(".ui-cytoscape-panzoom",b).animate({top:-65},300),$(".graphnavigator",b).animate({left:c-350},{duration:300}),$(".scalebox",l).width(22).height(22),$(".scalebox .scalebtn-full",l).show(),$(".scalebox .scaleimg,.scalebox .scalebtn-small",l).hide()),$(".infolistcontent",l).css("height","auto"),setTimeout(function(){h.resize(),t=!1},400)}};return{init:n,show:s,refresh:r,scale:u}}});
