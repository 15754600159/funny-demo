define("scopa/core/common/comment",[],function(){var a={get:mining.baseurl.core+"/comment/getByCommentId",list:mining.baseurl.core+"/comment/getByElementId",add:mining.baseurl.core+"/comment/add",del:mining.baseurl.core+"/comment/del"},b=function(b){var c=$.extend({id:"",title:"获取标注信息",success:null,error:null},b);mining.utils.isEmpty(c.id)||$ajax.ajax({url:a.get,data:{sid:c.id},success:function(a){!mining.utils.isEmpty(c.success)&&$.isFunction(c.success)&&c.success.call(this,a)},error:function(a){mining.utils.alertMsg(a,c.title+"失败，请稍后重试！","error"),!mining.utils.isEmpty(c.error)&&$.isFunction(c.error)&&c.error.call(this,a)}})},c=function(b){var c=$.extend({id:"",title:"获取标注列表",pageNo:1,pageSize:50,success:null,error:null},b);mining.utils.isEmpty(c.id)||$ajax.ajax({url:a.list,data:{id:c.id,pageNo:c.pageNo,pageSize:c.pageSize},success:function(a){!mining.utils.isEmpty(c.success)&&$.isFunction(c.success)&&c.success.call(this,a)},error:function(){mining.utils.alertMsg(data,c.title+"失败，请稍后重试！","error"),!mining.utils.isEmpty(c.error)&&$.isFunction(c.error)&&c.error.call(this,data)}})},d=function(b){var c=$.extend({uid:mining.userinfo.user_id,eid:"",type:"",title:"创建标注",success:null,error:null},b);mining.utils.isEmpty(c.uid)||mining.utils.isEmpty(c.eid)||$dialog({title:c.title,width:600,onshow:function(){var a=this;$(this.node),$(".main").addClass("blur"),a.content(['<form class="form-horizontal required-validate" onsubmit="return false;">','<div class="form-group">','<label class="col-sm-2 control-label">标注内容</label>','<div class="col-sm-10">','<textarea name="comment" class="form-control" placeholder="请填写..." style="height:200px;"></textarea>',"</div>","</div>","</form>"].join(""))},okValue:"确定",ok:function(){var b=this,d=$(this.node),e=$("[name=comment]",d).val();return mining.utils.isEmpty(e)?!1:($ajax.ajax({url:a.add,data:{content:JSON.stringify({uid:c.uid,eid:c.eid,type:c.type,comment:e})},type:"post",success:function(a){b.close().remove(),$dialog.alert(c.title+"成功！","success"),!mining.utils.isEmpty(c.success)&&$.isFunction(c.success)&&c.success.call(this,a)},error:function(a){mining.utils.alertMsg(a,c.title+"失败，请稍后重试！","error"),!mining.utils.isEmpty(c.error)&&$.isFunction(c.error)&&c.error.call(this,a)}}),!1)},cancelValue:"取消",cancel:!0,onclose:function(){$(".main").removeClass("blur")}}).showModal()},e=function(b){var c=$.extend({id:"",title:"删除标注",success:null,error:null},b);mining.utils.isEmpty(c.id)||$dialog.confirm({title:c.title,content:"您确定要删除该标注信息吗？",ok:function(){$ajax.ajax({url:a.del,data:{id:c.id},success:function(a){$dialog.alert(c.title+"成功！","success"),!mining.utils.isEmpty(c.success)&&$.isFunction(c.success)&&c.success.call(this,a)},error:function(a){mining.utils.alertMsg(a,c.title+"失败，请稍后重试！","error"),!mining.utils.isEmpty(c.error)&&$.isFunction(c.error)&&c.error.call(this,a)}})}})};return{get:b,list:c,add:d,del:e}});
