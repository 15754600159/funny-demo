define("scopa/core/graph/toolbar/dataflow",[],function(){function a(a,b,c,d){this.time=a||2e3,this.count=b||100;var c="string"==typeof c?c:"";this.alg=/^(uniform|acc|dec|accdec|arc-acc|arc-dec|arc-accdec)$/i.test(c)?c.toLowerCase():"arc-dec",this.callback=d,this.timer=null}function b(){var a=$("#"+e).find("."+f+'[data-flow="bothway"]');d.run(function(b){$.each(a,function(){var a=$(this).attr("data-index"),c=i[a];$(this).css({left:c.x1+(c.x2-c.x1)*b,top:c.y1+(c.y2-c.y1)*b})})},function(){d.run(function(b){$.each(a,function(){var a=$(this).attr("data-index"),c=i[a];$(this).css({left:c.x2+(c.x1-c.x2)*b,top:c.y2+(c.y1-c.y2)*b})})},function(){b()})})}function c(){var a=$("#"+e).find("."+f+'[data-flow="oneway"]');d.run(function(b){$.each(a,function(){var a=$(this).attr("data-index"),c=i[a];$(this).css({left:c.x1+(c.x2-c.x1)*b,top:c.y1+(c.y2-c.y1)*b})})},function(){c()})}a.prototype={run:function(a,b){var c=this,d=1;return this.timer=setInterval(function(){if(d>c.count)c.stop(),"function"==typeof b&&b();else{switch(c.alg){case"uniform":a(d/c.count);break;case"acc":var e=1e3*(1e3*(.001*d/c.count)*d/c.count);a(e/1e3);break;case"dec":var e=1e3*(2*d/c.count)-1e3*(1e3*(.001*d/c.count)*d/c.count);a(e/1e3);break;case"accdec":var f=1e3*(d/c.count);if(500>f)var e=.002*f*f;else{f-=500;var e=500+2*f-.002*f*f}a(e/1e3);break;case"arc-acc":var g=1e3*(d/c.count),h=1e3-Math.pow(1e6-g*g,.5);a(h/1e3);break;case"arc-dec":var g=1e3-1e3*(d/c.count),h=Math.pow(1e6-g*g,.5);a(h/1e3);break;case"arc-accdec":var g=1e3*(d/c.count);if(500>g)var h=500-Math.pow(25e4-g*g,.5);else{g=1e3-g;var h=500+Math.pow(25e4-g*g,.5)}a(h/1e3)}d+=1}},0==parseInt(this.time/this.count)?1:parseInt(this.time/this.count)),this},stop:function(){return clearInterval(this.timer),"function"==typeof this.callback&&this.callback(),this},init:function(){this.stop()}},new a(500,100,"uniform");var d=new a(500,100,"uniform"),e="dataflowbox",f="dataflow-node",g='<span class="dataflow-node dataflow-node1"></span>',h='<span class="dataflow-node dataflow-node2"></span>',i=[],j=function(a){$("#dataflowbox").remove(),$("#graphChart").after('<div class="dataflowbox" id="dataflowbox"></div>'),$("#dataflowbox").width($("#graphChart").width()).height($("#graphChart").height()),i=a,$.each(i,function(a){var b="";b="oneway"==this.d?g:h,b=$(b).css({top:this.x1,left:this.y1}).attr("data-flow",this.d).attr("data-index",a),$("#"+e).append(b)})},k=function(a){j(a),"oneway"==a[0].d?c():b()},l=function(){d.stop(),$("#dataflowbox").remove()};return{init:j,run:k,stop:l}});
