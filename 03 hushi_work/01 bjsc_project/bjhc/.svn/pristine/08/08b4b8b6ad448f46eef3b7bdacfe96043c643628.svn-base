/**
 * 分页控件
 * @param total
 */
function qkmpPagination(data) {
	// console.log(data);
	BootstrapPagination($("#qkmp-pagination"), {
		layoutScheme: "lefttext,pagesizelist,firstpage,prevgrouppage,prevpage,pagenumber,nextpage,nextgrouppage,lastpage,pageinput,righttext",
		//记录总数。
		total: data.total,
		//分页尺寸。指示每页最多显示的记录数量。
		pageSize: data.pageSize,
		//当前页索引编号。从其开始（从0开始）的整数。
		pageIndex: data.pageNumber-1,
		//指示分页导航栏中最多显示的页索引数量。
		pageGroupSize: 10,
		//位于导航条左侧的输出信息格式化字符串
		leftFormateString: "本页{count}条记录/共{total}条记录",
		//位于导航条右侧的输出信息格式化字符串
		rightFormateString: "第{pageNumber}页/共{totalPages}页",
		//页码文本格式化字符串。
		pageNumberFormateString: "{pageNumber}",
		//分页尺寸输出格式化字符串
		pageSizeListFormateString: "每页显示{pageSize}条记录",
		//上一页导航按钮文本。
		prevPageText: "上一页",
		//下一页导航按钮文本。
		nextPageText: "下一页",
		//上一组分页导航按钮文本。
		prevGroupPageText: "上一组",
		//下一组分页导航按钮文本。
		nextGroupPageText: "下一组",
		//首页导航按钮文本。
		firstPageText: "首页",
		//尾页导航按钮文本。
		lastPageText: "尾页",
		//设置页码输入框中显示的提示文本。
		pageInputPlaceholder: "GO",
		//接受用户输入内容的延迟时间。单位：毫秒
		pageInputTimeout: 800,
		//分页尺寸列表。
		pageSizeList: [5, 10, 20],
		//当分页更改后引发此事件。
		pageChanged: function(pageIndex, pageSize) {
			//getScData();
			paginationQuery(pageIndex+1, pageSize,qkmpPagination)
		},
	});
}
function paginationQuery(pageIndex,pageSize,qkmpPagination){
	$.ajax({
		type: "get",
		url: qkmphost+ "/api/task/serach?pageSize="+pageSize+"&pageNum="+pageIndex,
		async: true,
		success: function(data) {
			// console.log(data)
			
			var total = data.msg.totalCount;
			var items = data.msg.items
			$('#bd_task_tbody').empty()
			for(var i = 0; i < items.length; i++) {
				var statusStr = "";
				var statusHtml = '<div class="progress-bar" role="progressbar" style="width: 80%;">80%</div>';
				if(items[i].status){
					if(items[i].status==1){
						statusStr = "执行中";
					}else if(items[i].status==2){
						statusStr = "执行完成";
						statusHtml = '<div class="progress-bar" role="progressbar" style="width: 100%;">100%</div>';
					}
				}
				$("#bd_task_tbody").append(
					'<tr>'+
	                '<td>'+(items[i].name?items[i].name:"")+'</td>'+
	                '<td>'+items[i].createUserid+'</td>'+
	                '<td>'+formatDate(items[i].exeTime)+'</td>'+
	                '<td>'+formatDate(items[i].exeEndTime)+'</td>'+
	                '<td>'+statusStr+'</td>'+
					'<td><div class="progress">'+statusHtml+'</div></td>'+
	                '<td class="cz" data-taskid = "' + items[i].id + '">'+
	                      '<a href="subview/qkmp.html?from=qkmprwlb&operation=check&taskId=' + items[i].id + '">查看</a>'+
	                      '<a href="subview/qkmp.html?from=qkmprwlb&operation=alter&taskId=' + items[i].id + '">修改</a>'+
	                      '<a href="#">删除</a>'+
	                      '<a href="#" class="result">查看摸排结果</a>'+
	                 '</td>'+
	               '</tr>'
				);
			}
			var page = {};
			page.total = data.msg.totalCount;
			page.count = items.length;
			page.pageNumber = data.msg.page;
			page.totalPages = data.msg.totalPageCount;
			page.pageSize = data.msg.pageSize;
			
			//分页
			qkmpPagination && qkmpPagination(page)
		}
	});
}

function qmkpDel(taskId){
	userId = getUser().loginName;
	$.ajax({
		type: "get",
		url: qkmphost+ "/api/task/delete?taskId="+taskId+"&userId="+userId,
		async: true,
		success: function(data) {
			
		}
	});
}

