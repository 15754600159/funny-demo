<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="UTF-8">
<title>车辆实时预警</title>
	<link rel="stylesheet" type="text/css" href="../css/plugins/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="../css/common.css" />
	<link rel="stylesheet" type="text/css" href="../css/plugins/daterangepicker-bs3.css" />
	<link rel="stylesheet" type="text/css" href="../css/ryhc.css" />
	<link rel="stylesheet" type="text/css" href="../css/animate.css" />
	<link rel="stylesheet" type="text/css" href="../css/EzServerClient.min.css" />
	<link rel="stylesheet" type="text/css" href="../css/plugins/zTreeStyle.css" />
	<link rel="stylesheet" type="text/css" href="../css/popup.css" />
	<link rel="stylesheet" type="text/css" href="../css/plugins/jquery-confirm.min.css" />
	<link rel="stylesheet" type="text/css" href="../css/plugins/bootstrap-datetimepicker.css" />
	<link rel="stylesheet" type="text/css" href="../css/EzServerClient.min.css" />

	<script type="text/javascript" src="../js/plugins/jquery-1.9.1.min.js"></script>
	<script src="../js/plugins/jquery.form.js"></script>
	<script type="text/javascript" src="../js/plugins/bootstrap.min.js"></script>
	<script type="text/javascript" src="../js/plugins/fetch.js"></script>
	<script type="text/javascript" src="../js/plugins/moment.js"></script>
	<script type="text/javascript" src="../js/plugins/daterangepicker.js"></script>
	<script type="text/javascript" src="../js/plugins/bootstrap-pagination.min.js"></script>
	<script type="text/javascript" src="../js/plugins/jquery.ztree.core.js"></script>
	<script type="text/javascript" src="../js/common/common.js"></script>
	<script type="text/javascript" src="../js/web/clssbdjl.js"></script>
	<script type="text/javascript" src="../js/common/xzqh.js"></script>
	<script type="text/javascript" src="../js/plugins/EzMapAPI.js"></script>
	<script type="text/javascript" src="../js/plugins/EzServerClient.min.js"></script>
	<script type="text/javascript" src="../js/common/jquery-confirm.min.js"></script>
	<script type="text/javascript" src="../js/common/bootstrap-datetimepicker.js"></script>
	<script type="text/javascript" src="../js/common/bootstrap-datetimepicker.zh-CN.js"></script>
</head>
<body>
	<SCRIPT type="text/javascript">
		var inputId;
		var setting = {
			view: {
				dblClickExpand: false
			},
			data: {
				simpleData: {
					enable: true
				}
			},
			callback: {
				beforeClick: beforeClick,
				onClick: onClick
			}
		};
		function sss(){
			$("#hjdqh").removeAttr("code");
		}
		var str = JSON.stringify(checkAddressTree);
		var checkAddress = JSON.parse( str );
		var zNodes=[];
		for(var i=0;i<checkAddress.length;i++){
				var n = {id:checkAddress[i].code, pId:checkAddress[i].pid, name:checkAddress[i].name};
				zNodes.push(n)
		}
		var dwdmNodes=[];
		$.ajax({
		    url: host+'/dwdm/info/findall',
		    type: 'GET',
		    dataType: 'json',
		    success: function(data){
		    	console.info(data)
		    	for(var i=0;i<data.length;i++){
		    			var n = {id:data[i].code, pId:data[i].pid, name:data[i].name};
		    			dwdmNodes.push(n)
		    	}
		    	$.fn.zTree.init($("#citySelUl"), setting, dwdmNodes);
		    }
		});
		
		

		function beforeClick(treeId, treeNode) {
			/*var check = (treeNode && !treeNode.isParent);
			if (!check) alert("只能选择具体地址");
			return check;*/
		}
		
		function onClick(e, treeId, treeNode) {
			var zTree = $.fn.zTree.getZTreeObj(treeId),
			nodes = zTree.getSelectedNodes(),
			v = "";
			code = "";
			nodes.sort(function compare(a,b){return a.id-b.id;});
			if(treeId == 'citySelUl'){
				for (var i=0, l=nodes.length; i<l; i++) {
					v += nodes[i].name + ",";
					code += nodes[i].id +"-"+ nodes[i].name + ",";
				}
			}else{
				for (var i=0, l=nodes.length; i<l; i++) {
					v += nodes[i].name + ",";
					code += nodes[i].code + ",";
				}
			}
			console.log(code);
			console.log(inputId);
			var cityObj = $("#"+inputId);
			console.log(cityObj);
			if (v.length > 0 ) v = v.substring(0, v.length-1);
			cityObj.val(v);
			if(treeId == 'citySelUl'){
				$("#ucodeName").val(v);
			}
			if (code.length > 0 ) code = code.substring(0, code.length-1);
			cityObj.attr("code", code);
		}

		function showMenu(id) {
			inputId = id;
			var cityObj = $("#"+inputId);
			var cityOffset = $("#"+inputId).offset();
			$("#"+inputId+"Content").css({left:cityOffset.left + "px", top:cityOffset.top + cityObj.outerHeight() + 2 + "px"}).slideDown("fast");

			$("body").bind("mousedown", onBodyDown);
		}
		function hideMenu() {
			$("#"+inputId+"Content").fadeOut("fast");
			$("body").unbind("mousedown", onBodyDown);
		}
		function onBodyDown(event) {
			if (!(event.target.id == "menuBtn" || event.target.id == "menuContent" || $(event.target).parents("#"+inputId+"Content").length>0)) {
				hideMenu();
			}
		}
		$(document).ready(function(){
			$.fn.zTree.init($("#hjdqhUl"), setting, xzqhNodes);
			$.fn.zTree.init($("#checkAddressUl"), setting, zNodes);
		});
		//-->
	</SCRIPT>
	<div class="all">
		<div class="top">
              <a href="#"><img src="../img/nav-logo.png"></a>
              <div class="role">
                    <a href="#">admin</a>
              </div>
        </div>
        <div class="serach-box content">
        	<div class="title">
        		<span>车辆实时预警</span>
			</div>
			<form action="#">
				<table class="serach-tab">
					<tbody>
						<tr>
							<td>机动车所有人：</td>
							<td><input type="text" class="form-control2" placeholder='机动车所有人' id="xm"></td>
							<td>身份证号：</td>
							<td><input type="text" class="form-control2" placeholder='身份证号' id="sfzh"></td>
							<td>车牌号：</td>
							<td><input type="text" class="form-control2" placeholder='车牌号' id="cph"></td>
							<td>户籍地：</td>
							<td><input type="text" onclick="showMenu('hjdqh'); return false;"  onchange="sss()" class="form-control2" placeholder='选择户籍地区划' id="hjdqh"></td>
							
							<td class="hide">车辆类型：</td>
							<td class="hide">
								<select class="form-control2" id="cllx">
									<option value="">-全部-</option>
								</select>
							</td>
							<td><button id="search-cl" class="btn btn-default">查询</button></td>
							<td>
								<input type="reset" class="btn btn-default" value="重置" />
							</td>
						</tr>
						<tr>
							<td>核录地点：</td>
							<td>
								<input id="checkAddress" code="" onclick="showMenu('checkAddress'); return false;" type="text" placeholder='选择核查地点' class="form-control2" />
							</td>
							<td>核录单位：</td>
							<td style="position: relative;">
								  <input id="citySel" code="" onclick="showMenu('citySel'); return false;" type="text" placeholder='选择核录单位' class="form-control2" />
								  <input id="ucodeName" type="hidden"> 	 
							</td>
							<td>核录时间起：</td>
							<td><input type="text" class="form-control2 form_datetime" placeholder='核录时间起' id="startTime"></td>
							<td>核录时间止：</td>
							<td><input type="text" class="form-control2 form_datetime" placeholder='核录时间止' id="endTime"></td>
						</tr>
						<tr>
							<td>前端预警：</td>
							<td>
								<select class="form-control2" id="yj">
									<option value="00">-全部-</option>
									<option value="01">-预警-</option>
								</select>
							</td>
							<td>预警类型：</td>
							<td>
								<select class="form-control2" id="yjlx">
									<option value="">-全部-</option>
								</select>
							</td>
							<td>警员姓名：</td>
							<td><input type="text" class="form-control2" placeholder='警员姓名' id="jyxm"></td>
							<td>警员警号：</td>
							<td><input type="text" class="form-control2" placeholder='警员警号' id="jyjh"></td>
						</tr>
						<tr>
							<td>车辆标签：</td>
							<td>
								<select class="form-control2" id="clbq">
								</select>
							</td>
	
							<td>设备类型：</td>
							<td>
								<select class="form-control2" id="qqly">
									<option value="">-全部-</option>
								</select>
							</td>
						</tr>
					</tbody>
				</table>
			</form>
		</div>
		<div class="tools-box">
			<div class="tools-box">
				<button id="export-cl" class="btn  btn-default" style=" position: absolute;
    right: 0px;">导出</button>			 
				<button  id="daomap" class="btn  btn-default">到地图</button>
			</div>
		</div>
		<div class="tableall">
			<div class="details-box">
				<!-- <table class="tab-details"> -->
				<table class="table table-bordered table-striped table-hover" style="table-layout: fixed;">
					<thead>
						<tr>
							<th style="width:4%">预警</th>
							<th style="width:4%">车牌号</th>
							<th style="width:4%">车辆类型</th>
							<th style="width:4%">机动车所有人</th>
							<th style="width:160px">身份证号</th>
							<th style="width:4%">户籍地</th>
							<th style="width:4%">推送目标</th>
							<th style="width:155px">核录时间</th>
							<th style="width:6%">核录地点</th>
							<th style="width:6%">核录单位</th>
							<th style="width:5%">设备类型</th>
							<th style="width:4%">警员姓名</th>
							<th style="width:4%">警员警号</th>
							<th style="width:6%">警员手机号</th>
							<th style="width:11%">处置要求</th>
							<th style="width:14%">车辆标签</th>
							<th style="width:80px">操作</th>
						</tr>
					</thead>
					<tbody id="tableBody">
						
					</tbody>
				</table>
			</div>
			<!-- 分页 -->
			<div style="text-align: right">
				<ul id="pagination" class="pagination">
				</ul>
			</div>
		</div>
		<div class="map" style="width: 100%;height: 600px;background: #fff;">
				<div id="map" style="width:100%;height:100%;"></div>
		</div>
		<script type="text/javascript">
			 map = new EzMap('map');
		</script>

		<div id="checkAddressContent" class="menuContent" style="display:none; position: absolute;background: #fff;height: 120px;">
			<ul id="checkAddressUl" class="ztree" style="margin-top:0; width:300px;"></ul>
		</div>
		<div id="citySelContent" class="menuContent" style="display:none; position: absolute;background: #fff;height: 120px;">
			<ul id="citySelUl" class="ztree" style="margin-top:0; width:300px;"></ul>
		</div>
		<div id="hjdqhContent" class="menuContent" style="display:none; position: absolute;background: #fff;height: 120px;">
		<ul id="hjdqhUl" class="ztree" style="margin-top:0; width:300px;"></ul>
		</div>
		<!-- 模态框（Modal） -->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 10%">
		    <div class="modal-dialog">
		        <div class="modal-content content-color">
		            <div class="modal-header header-color">
		                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		                <h4 class="modal-title" id="myModalLabel"></h4>
		            </div>
		            <div class="modal-body">
						<!-- <table class="table table-bordered table-striped table-hover">
							<thead id="tableHead">
								
							</thead>
							<tbody id="tableBody">
								
							</tbody>
						</table> -->
		            </div>
		        </div><!-- /.modal-content -->
		    </div><!-- /.modal -->
		</div>

	</div>
	<div class="modal fade" id="myModal_see" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 10%">
	    <div class="modal-dialog">
	        <div class="modal-content content-color">
	            <div class="modal-header header-color">
	                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	                <h4 class="modal-title" id="myModalLabel_see"></h4>
	            </div>
	            <div class="modal-body_see">
	            	<table class="table table-bordered table-striped table-hover">
						<tbody id="tableBody_modal_see">
							
						</tbody>
					</table>
	            </div>
	        </div><!-- /.modal-content -->
	    </div><!-- /.modal -->
	</div>
</body>
</html>