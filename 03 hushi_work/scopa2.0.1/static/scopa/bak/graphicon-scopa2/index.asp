<% 
Dim xml : Set xml=Server.CreateObject("MSXML2.DOMDocument") 
Dim stm : Set stm=Server.CreateObject("ADODB.Stream") 
MyArray = Array("entity","relation","event","entity_graphicon_bayonet","entity_graphicon_qq_and_wechat_group_number","entity_graphicon_qq_and_wechat_number","entity_graphicon_cell_phone_imei","entity_graphicon_cell_phone_mac","entity_graphicon_browser_account","entity_graphicon_public_security_intelligence","entity_graphicon_email_account_suser","entity_graphicon_email_accounts","entity_graphicon_email_accounts_manger","entity_graphicon_flights","entity_graphicon_micro_blog_account","entity_graphicon_taobao_account","entity_graphicon_unfocuscriminalrecord","entity_graphicon_focuscriminalrecord","entity_graphicon_product","entity_graphicon_video","entity_graphicon_audio","entity_graphicon_picture","entity_graphicon_document","entity_graphicon_file","entity_graphicon_account","entity_graphicon_architecture","entity_graphicon_organization","entity_graphicon_wifi","entity_graphicon_IP","entity_graphicon_wechat","entity_graphicon_QQ","entity_graphicon_bank_card","entity_graphicon_mac","entity_graphicon_train","entity_graphicon_aircraft","entity_graphicon_hotel","entity_graphicon_case","entity_graphicon_phone","entity_graphicon_mobel_phone","entity_graphicon_telephone","entity_graphicon_collective_household","entity_graphicon_small_car","entity_graphicon_registered_residence","entity_graphicon_families","entity_graphicon_big_car","entity_graphicon_car","entity_graphicon_human","relation_graphicon_human_alarm","relation_graphicon_people_reported_the_cas","relation_graphicon_car2","relation_graphicon_cell_phone","relation_graphicon_cell_phonenumber","relation_graphicon_group_members","relation_graphicon_guardian","relation_graphicon_police_case","relation_graphicon_telephone_directory","relation_graphicon_victim_warning_instance","relation_graphicon_victimsof_the_case","relation_graphicon_browser_account2","relation_graphicon_email","relation_graphicon_father_child","relation_graphicon_micro_blog_friends","relation_graphicon_micro_blog_staterelease","relation_graphicon_people_involved_in_the_case","relation_graphicon_qq_and_wechat_friends","relation_graphicon_qq_and_wechat_number2","relation_graphicon_taobao","relation_graphicon_mate","relation_graphicon_mother_child","relation_graphicon_paccancy","relation_graphicon_the_part_of","relation_graphicon_mixture","relation_graphicon_suspiction","relation_graphicon_communication","relation_graphicon_relatives","relation_graphicon_live_together","relation_graphicon_went_together","event_graphicon_accommodation","event_graphicon_booking","event_graphicon_case2","event_graphicon_checkpoint","event_graphicon_communication2","event_graphicon_departures","event_graphicon_email2","event_graphicon_household_register","event_graphicon_internet_cafe","event_graphicon_micro_blog_privateletter","event_graphicon_micro_blog_staterelease2","event_graphicon_mobile_sms","event_graphicon_mobilephone_company_wifi","event_graphicon_no_wifi","event_graphicon_paccancy2","event_graphicon_qq_and_wechat_chat","event_graphicon_qq_and_wechat_groupchat","event_graphicon_qq_and_wechat_staterelease","event_graphicon_taobao_search","event_graphicon_taobao_view","event_graphicon_train2","event_graphicon_url_view","entity_locked","relation_locked","event_locked","entity_graphicon_bayonet_locked","entity_graphicon_qq_and_wechat_group_number_locked","entity_graphicon_qq_and_wechat_number_locked","entity_graphicon_cell_phone_imei_locked","entity_graphicon_cell_phone_mac_locked","entity_graphicon_browser_account_locked","entity_graphicon_public_security_intelligence_locked","entity_graphicon_email_account_suser_locked","entity_graphicon_email_accounts_locked","entity_graphicon_email_accounts_manger_locked","entity_graphicon_flights_locked","entity_graphicon_micro_blog_account_locked","entity_graphicon_taobao_account_locked","entity_graphicon_unfocuscriminalrecord_locked","entity_graphicon_focuscriminalrecord_locked","entity_graphicon_product_locked","entity_graphicon_video_locked","entity_graphicon_audio_locked","entity_graphicon_picture_locked","entity_graphicon_document_locked","entity_graphicon_file_locked","entity_graphicon_account_locked","entity_graphicon_architecture_locked","entity_graphicon_organization_locked","entity_graphicon_wifi_locked","entity_graphicon_IP_locked","entity_graphicon_wechat_locked","entity_graphicon_QQ_locked","entity_graphicon_bank_card_locked","entity_graphicon_mac_locked","entity_graphicon_train_locked","entity_graphicon_aircraft_locked","entity_graphicon_hotel_locked","entity_graphicon_case_locked","entity_graphicon_phone_locked","entity_graphicon_mobel_phone_locked","entity_graphicon_telephone_locked","entity_graphicon_collective_household_locked","entity_graphicon_small_car_locked","entity_graphicon_registered_residence_locked","entity_graphicon_families_locked","entity_graphicon_big_car_locked","entity_graphicon_car_locked","entity_graphicon_human_locked","relation_graphicon_human_alarm_locked","relation_graphicon_people_reported_the_cas_locked","relation_graphicon_car2_locked","relation_graphicon_cell_phone_locked","relation_graphicon_cell_phonenumber_locked","relation_graphicon_group_members_locked","relation_graphicon_guardian_locked","relation_graphicon_police_case_locked","relation_graphicon_telephone_directory_locked","relation_graphicon_victim_warning_instance_locked","relation_graphicon_victimsof_the_case_locked","relation_graphicon_browser_account2_locked","relation_graphicon_email_locked","relation_graphicon_father_child_locked","relation_graphicon_micro_blog_friends_locked","relation_graphicon_micro_blog_staterelease_locked","relation_graphicon_people_involved_in_the_case_locked","relation_graphicon_qq_and_wechat_friends_locked","relation_graphicon_qq_and_wechat_number2_locked","relation_graphicon_taobao_locked","relation_graphicon_mate_locked","relation_graphicon_mother_child_locked","relation_graphicon_paccancy_locked","relation_graphicon_the_part_of_locked","relation_graphicon_mixture_locked","relation_graphicon_suspiction_locked","relation_graphicon_communication_locked","relation_graphicon_relatives_locked","relation_graphicon_live_together_locked","relation_graphicon_went_together_locked","event_graphicon_accommodation_locked","event_graphicon_booking_locked","event_graphicon_case2_locked","event_graphicon_checkpoint_locked","event_graphicon_communication2_locked","event_graphicon_departures_locked","event_graphicon_email2_locked","event_graphicon_household_register_locked","event_graphicon_internet_cafe_locked","event_graphicon_micro_blog_privateletter_locked","event_graphicon_micro_blog_staterelease2_locked","event_graphicon_mobile_sms_locked","event_graphicon_mobilephone_company_wifi_locked","event_graphicon_no_wifi_locked","event_graphicon_paccancy2_locked","event_graphicon_qq_and_wechat_chat_locked","event_graphicon_qq_and_wechat_groupchat_locked","event_graphicon_qq_and_wechat_staterelease_locked","event_graphicon_taobao_search_locked","event_graphicon_taobao_view_locked","event_graphicon_train2_locked","event_graphicon_url_view_locked")
xml.resolveExternals=False 
xml.load Server.MapPath("base.xml") 
Set rootNode = xml.documentElement
nodeLen = rootNode.ChildNodes.length - 1
rootNode.setAttribute "xmlns:dt","urn:schemas-microsoft-com:datatypes" 

for i = 0 to nodeLen
Set iconNode = rootNode.ChildNodes.item(i)
iconNode.dataType = "bin.base64"
stm.Type=1 'adTypeBinary 
stm.Open 
stm.Write iconNode.nodeTypedValue

stm.SaveToFile Server.MapPath( MyArray(i) & ".png")
stm.Close

Next

Set xml=Nothing 
Set stm=Nothing 
%>

<%= "<h1>Well Done!</h1>"%>
